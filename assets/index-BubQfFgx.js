import{g as Le,d as Q,t as ne,n as J,c as fe,u as pe,a as ge,b as c,F as me,p as H,w as he,e as Ae,i as Re,s as ze,f as Fe,h as $e,j as Ne,r as Oe,k as T,l as qe,m as A,o as ae,q as De,v as We,x as j,y as je,C as He,z,A as Ue,B as Ke,I as U,D as Ye,E as K,G as Je,H as Ge,J as le,K as Y,L as ie,M as Qe,N as Xe,O as Ze,P as oe,Q as se,R as I,S as et,T as tt,U as O,V as nt,W as re,X as at,Y as p,Z as ce,_ as lt}from"./index-DY_YJ-Sf.js";let it=0;function ot(){const e=Le(),{name:n="unknown"}=e?.type||{};return`${n}-${++it}`}const[st,rt]=fe("form"),ct={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:J,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:ne,showErrorMessage:ne,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var ut=Q({name:st,props:ct,emits:["submit","failed"],setup(e,{emit:n,slots:s}){const{children:d,linkChildren:o}=pe(me),f=a=>a?d.filter(r=>a.includes(r.name)):d,x=a=>new Promise((r,g)=>{const k=[];f(a).reduce((q,$)=>q.then(()=>{if(!k.length)return $.validate().then(N=>{N&&k.push(N)})}),Promise.resolve()).then(()=>{k.length?g(k):r()})}),P=a=>new Promise((r,g)=>{const k=f(a);Promise.all(k.map(u=>u.validate())).then(u=>{u=u.filter(Boolean),u.length?g(u):r()})}),y=a=>{const r=d.find(g=>g.name===a);return r?new Promise((g,k)=>{r.validate().then(u=>{u?k(u):g()})}):Promise.reject()},_=a=>typeof a=="string"?y(a):e.validateFirst?x(a):P(a),v=a=>{typeof a=="string"&&(a=[a]),f(a).forEach(g=>{g.resetValidation()})},F=()=>d.reduce((a,r)=>(a[r.name]=r.getValidationStatus(),a),{}),B=(a,r)=>{d.some(g=>g.name===a?(g.$el.scrollIntoView(r),!0):!1)},R=()=>d.reduce((a,r)=>(r.name!==void 0&&(a[r.name]=r.formValue.value),a),{}),C=()=>{const a=R();_().then(()=>n("submit",a)).catch(r=>{n("failed",{values:a,errors:r});const{scrollToError:g,scrollToErrorPosition:k}=e;g&&r[0].name&&B(r[0].name,k?{block:k}:void 0)})},m=a=>{H(a),C()};return o({props:e}),ge({submit:C,validate:_,getValues:R,scrollToField:B,resetValidation:v,getValidationStatus:F}),()=>{var a;return c("form",{class:rt(),onSubmit:m},[(a=s.default)==null?void 0:a.call(s)])}}});const dt=he(ut);function ve(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function ft(e,n){if(ve(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function gt(e,n){return new Promise(s=>{const d=n.validator(e,n);if($e(d)){d.then(s);return}s(d)})}function ue(e,n){const{message:s}=n;return Fe(s)?s(e,n):s||""}function mt({target:e}){e.composing=!0}function de({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function ht(e,n){const s=Ae();e.style.height="auto";let d=e.scrollHeight;if(Re(n)){const{maxHeight:o,minHeight:f}=n;o!==void 0&&(d=Math.min(d,o)),f!==void 0&&(d=Math.max(d,f))}d&&(e.style.height=`${d}px`,ze(s))}function vt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function E(e){return[...e].length}function G(e,n){return[...e].slice(0,n).join("")}const[bt,S]=fe("field"),yt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:J,max:Number,min:Number,formatter:Function,clearIcon:K("clear"),modelValue:Je(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:K("focus"),formatTrigger:K("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},kt=Ne({},Ye,yt,{rows:J,type:K("text"),rules:Array,autosize:[Boolean,Object],labelWidth:J,labelClass:Ge,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var St=Q({name:bt,props:kt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:s}){const d=ot(),o=Oe({status:"unvalidated",focused:!1,validateMessage:""}),f=T(),x=T(),P=T(),{parent:y}=qe(me),_=()=>{var t;return String((t=e.modelValue)!=null?t:"")},v=t=>{if(z(e[t]))return e[t];if(y&&z(y.props[t]))return y.props[t]},F=A(()=>{const t=v("readonly");if(e.clearable&&!t){const l=_()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&o.focused;return l&&i}return!1}),B=A(()=>P.value&&s.input?P.value():e.modelValue),R=A(()=>{var t;const l=v("required");return l==="auto"?(t=e.rules)==null?void 0:t.some(i=>i.required):l}),C=t=>t.reduce((l,i)=>l.then(()=>{if(o.status==="failed")return;let{value:h}=B;if(i.formatter&&(h=i.formatter(h,i)),!ft(h,i)){o.status="failed",o.validateMessage=ue(h,i);return}if(i.validator)return ve(h)&&i.validateEmpty===!1?void 0:gt(h,i).then(b=>{b&&typeof b=="string"?(o.status="failed",o.validateMessage=b):b===!1&&(o.status="failed",o.validateMessage=ue(h,i))})}),Promise.resolve()),m=()=>{o.status="unvalidated",o.validateMessage=""},a=()=>n("endValidate",{status:o.status,message:o.validateMessage}),r=(t=e.rules)=>new Promise(l=>{m(),t?(n("startValidate"),C(t).then(()=>{o.status==="failed"?(l({name:e.name,message:o.validateMessage}),a()):(o.status="passed",l(),a())})):l()}),g=t=>{if(y&&e.rules){const{validateTrigger:l}=y.props,i=le(l).includes(t),h=e.rules.filter(b=>b.trigger?le(b.trigger).includes(t):i);h.length&&r(h)}},k=t=>{var l;const{maxlength:i}=e;if(z(i)&&E(t)>+i){const h=_();if(h&&E(h)===+i)return h;const b=(l=f.value)==null?void 0:l.selectionEnd;if(o.focused&&b){const M=[...t],L=M.length-+i;return M.splice(b-L,L),M.join("")}return G(t,+i)}return t},u=(t,l="onChange")=>{var i,h;const b=t;t=k(t);const M=E(b)-E(t);if(e.type==="number"||e.type==="digit"){const V=e.type==="number";if(t=Ue(t,V,V),l==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const w=Ke(+t,(i=e.min)!=null?i:-1/0,(h=e.max)!=null?h:1/0);+t!==w&&(t=w.toString())}}let L=0;if(e.formatter&&l===e.formatTrigger){const{formatter:V,maxlength:w}=e;if(t=V(t),z(w)&&E(t)>+w&&(t=G(t,+w)),f.value&&o.focused){const{selectionEnd:W}=f.value,te=G(b,W);L=E(V(te))-E(te)}}if(f.value&&f.value.value!==t)if(o.focused){let{selectionStart:V,selectionEnd:w}=f.value;if(f.value.value=t,z(V)&&z(w)){const W=E(t);M?(V-=M,w-=M):L&&(V+=L,w+=L),f.value.setSelectionRange(Math.min(V,W),Math.min(w,W))}}else f.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},q=t=>{t.target.composing||u(t.target.value)},$=()=>{var t;return(t=f.value)==null?void 0:t.blur()},N=()=>{var t;return(t=f.value)==null?void 0:t.focus()},D=()=>{const t=f.value;e.type==="textarea"&&e.autosize&&t&&ht(t,e.autosize)},be=t=>{o.focused=!0,n("focus",t),j(D),v("readonly")&&$()},ye=t=>{o.focused=!1,u(_(),"onBlur"),n("blur",t),!v("readonly")&&(g("onBlur"),j(D),Qe())},X=t=>n("clickInput",t),ke=t=>n("clickLeftIcon",t),Se=t=>n("clickRightIcon",t),_e=t=>{H(t),n("update:modelValue",""),n("clear",t)},Z=A(()=>{if(typeof e.error=="boolean")return e.error;if(y&&y.props.showError&&o.status==="failed")return!0}),we=A(()=>{const t=v("labelWidth"),l=v("labelAlign");if(t&&l!=="top")return{width:ae(t)}}),Ve=t=>{t.keyCode===13&&(!(y&&y.props.submitOnEnter)&&e.type!=="textarea"&&H(t),e.type==="search"&&$()),n("keypress",t)},ee=()=>e.id||`${d}-input`,xe=()=>o.status,Ce=()=>{const t=S("control",[v("inputAlign"),{error:Z.value,custom:!!s.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(s.input)return c("div",{class:t,onClick:X},[s.input()]);const l={id:ee(),ref:f,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:v("disabled"),readonly:v("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${d}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:ye,onFocus:be,onInput:q,onClick:X,onChange:de,onKeypress:Ve,onCompositionend:de,onCompositionstart:mt};return e.type==="textarea"?c("textarea",ie(l,{inputmode:e.inputmode}),null):c("input",ie(vt(e.type,e.inputmode),l),null)},Ie=()=>{const t=s["left-icon"];if(e.leftIcon||t)return c("div",{class:S("left-icon"),onClick:ke},[t?t():c(U,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ee=()=>{const t=s["right-icon"];if(e.rightIcon||t)return c("div",{class:S("right-icon"),onClick:Se},[t?t():c(U,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Pe=()=>{if(e.showWordLimit&&e.maxlength){const t=E(_());return c("div",{class:S("word-limit")},[c("span",{class:S("word-num")},[t]),Y("/"),e.maxlength])}},Te=()=>{if(y&&y.props.showErrorMessage===!1)return;const t=e.errorMessage||o.validateMessage;if(t){const l=s["error-message"],i=v("errorMessageAlign");return c("div",{class:S("error-message",i)},[l?l({message:t}):t])}},Be=()=>{const t=v("labelWidth"),l=v("labelAlign"),i=v("colon")?":":"";if(s.label)return[s.label(),i];if(e.label)return c("label",{id:`${d}-label`,for:s.input?void 0:ee(),"data-allow-mismatch":"attribute",onClick:h=>{H(h),N()},style:l==="top"&&t?{width:ae(t)}:void 0},[e.label+i])},Me=()=>[c("div",{class:S("body")},[Ce(),F.value&&c(U,{ref:x,name:e.clearIcon,class:S("clear")},null),Ee(),s.button&&c("div",{class:S("button")},[s.button()])]),Pe(),Te()];return ge({blur:$,focus:N,validate:r,formValue:B,resetValidation:m,getValidationStatus:xe}),Xe(Ze,{customValue:P,resetValidation:m,validateWithTrigger:g}),De(()=>e.modelValue,()=>{u(_()),m(),g("onChange"),j(D)}),We(()=>{u(_(),e.formatTrigger),j(D)}),je("touchstart",_e,{target:A(()=>{var t;return(t=x.value)==null?void 0:t.$el})}),()=>{const t=v("disabled"),l=v("labelAlign"),i=Ie(),h=()=>{const b=Be();return l==="top"?[i,b].filter(Boolean):b||[]};return c(He,{size:e.size,class:S({error:Z.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:we.value,valueClass:S("value"),titleClass:[S("label",[l,{required:R.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&l!=="top"?()=>i:null,title:h,value:Me,extra:s.extra})}}});const _t=he(St),wt={class:"page-container login-container"},Vt={class:"login-card"},xt={class:"login-header"},Ct={class:"login-icon"},It={class:"role-tabs"},Et=["onClick"],Pt={class:"help-section"},Tt=Q({name:"LoginView",__name:"index",setup(e){const n=T("dealer"),s=T(""),d=T(""),o=T(!1),f=T(!1),x=at(),P=[{key:"dealer",label:"荷官端",icon:"user-o",description:"尋找班別,管理應徵"},{key:"employer",label:"商家端",icon:"shop-o",description:"建立班別,管理名單"},{key:"admin",label:"管理端",icon:"shield-o",description:"審核時數,系統管理"}],y=A(()=>`登入${P.find(m=>m.key===n.value)?.label}`),_=()=>s.value?d.value?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value)?!0:(p("請輸入正確的電子信箱格式"),!1):(p("請輸入您的密碼"),!1):(p("請輸入您的電子信箱"),!1),v=async()=>{if(_()){f.value=!0;try{switch(await new Promise(C=>setTimeout(C,1e3)),n.value){case"dealer":x.push("/u/shifts");break;case"employer":x.push("/e/shifts");break;case"admin":x.push("/a/audit");break;default:x.push("/")}p("登入成功")}catch{p("登入失敗，請稍後再試")}finally{f.value=!1}}},F=()=>{o.value=!o.value},B=()=>{p("跳轉到幫助中心")},R=()=>{p("跳轉到聯絡客服")};return(C,m)=>{const a=U,r=_t,g=nt,k=dt;return se(),oe("div",wt,[I("div",Vt,[I("div",xt,[I("div",Ct,[c(a,{name:"user-circle-o",size:"60",color:"#155dfc"})]),m[2]||(m[2]=I("h1",{class:"login-title"},"歡迎登入",-1)),m[3]||(m[3]=I("p",{class:"login-subtitle"},"選擇您的身份類型並登入系統",-1))]),I("div",It,[(se(),oe(et,null,tt(P,u=>I("div",{key:u.key,class:ce(["role-tab",{active:n.value===u.key}]),onClick:q=>n.value=u.key},[c(a,{name:u.icon,size:"20",class:ce(`role-icon role-icon--${u.key}`)},null,8,["name","class"]),I("span",null,re(u.label),1)],10,Et)),64))]),c(k,{onSubmit:v,class:"login-form"},{default:O(()=>[c(r,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=u=>s.value=u),name:"email",label:"電子信箱",placeholder:"請輸入您的電子信箱",type:"email",rules:[{required:!0,message:"請輸入電子信箱"}],class:"login-field","label-align":"top"},null,8,["modelValue"]),c(r,{modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=u=>d.value=u),name:"password",label:"密碼",placeholder:"請輸入您的密碼",type:o.value?"text":"password",rules:[{required:!0,message:"請輸入密碼"}],class:"login-field","label-align":"top"},{"right-icon":O(()=>[c(a,{name:o.value?"eye-o":"closed-eye",onClick:F,class:"password-toggle"},null,8,["name"])]),_:1},8,["modelValue","type"]),c(g,{type:"primary",size:"large",loading:f.value,"loading-text":"登入中...",onClick:v,class:"login-button"},{default:O(()=>[Y(re(y.value),1)]),_:1},8,["loading"])]),_:1}),I("div",Pt,[c(g,{type:"default",size:"small",class:"help-button",onClick:B},{default:O(()=>[c(a,{name:"question-o",size:"16"}),m[4]||(m[4]=Y(" 幫助中心 ",-1))]),_:1}),c(g,{type:"default",size:"small",class:"help-button",onClick:R},{default:O(()=>[c(a,{name:"service-o",size:"16"}),m[5]||(m[5]=Y(" 聯絡客服 ",-1))]),_:1})])])])}}}),Mt=lt(Tt,[["__scopeId","data-v-07c0c129"]]);export{Mt as default};
